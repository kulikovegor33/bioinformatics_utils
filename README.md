# DNA/RNA Tools and FASTQ Filter

Этот проект содержит функции для работы с последовательностями ДНК/РНК и фильтрации последовательностей в формате FASTQ.

## Оглавление

- [Установка](#установка)
- [Использование](#использование)
  - [Функция run_dna_rna_tools](#функция-rundna_rna_tools)
  - [Функция filter_fastq](#функция-filter_fastq)
- [Исключения](#исключения)
- [Примеры](#примеры)

## Установка

Убедитесь, что у вас установлен Python 3.6 или выше. Затем установите необходимые библиотеки, если они не установлены.

```bash
pip install -r requirements.txt
```
## Использование

### Функция run_dna_rna_tools

Эта функция выполняет указанные процедуры (транскрипция, реверс, комплементарность) для заданных последовательностей ДНК/РНК.

```python
def run_dna_rna_tools(*args: Union[str, List[str]]) -> Union[str, List[str], None]:
```
#### Аргументы

- *args: Последовательности ДНК/РНК и процедура, которую нужно выполнить. Последний аргумент должен быть строкой, обозначающей процедуру.

#### Возвращаемое значение

- Результат выполнения процедуры:
  - Если процедура "transcribe", возвращает транскрибированную последовательность.
  - Если процедура "reverse", возвращает развёрнутую последовательность.
  - Если процедура "complement", возвращает комплементарную последовательность.
  - Если процедура "reverse_complement", возвращает обратную комплементарную последовательность.

Если последовательностей одна, возвращает строку, если больше одной — список строк. Если последовательностей нет, возвращает None.

### Функция filter_fastq

Эта функция фильтрует последовательности в формате FASTQ на основе заданных критериев.

```python
def filter_fastq(seqs: Dict[str, Tuple[str, str]], gc_bounds: Tuple[float, float] = (0.0, 100.0), length_bounds: Tuple[int, int] = (0, 2**32), quality_threshold: int = 0) -> Dict[str, Tuple[str, str]]:
```
#### Аргументы

- seqs: Словарь с именами последовательностей в качестве ключей и кортежами (последовательность, качество) в качестве значений.
- gc_bounds: Интервал GC-состава (в процентах) для фильтрации. По умолчанию (0, 100) — все риды сохраняются.
- length_bounds: Интервал длины для фильтрации. По умолчанию (0, 2**32).
- quality_threshold: Пороговое значение среднего качества рида для фильтрации. По умолчанию равно 0 (шкала phred33).

#### Возвращаемое значение

- Словарь с отфильтрованными последовательностями в формате {имя_последовательности: (последовательность, качество)}.

## Исключения

- ValueError: Если последовательность недействительна или процедура неизвестна.

## Примеры

### Пример использования функции run_dna_rna_tools

```python
result = run_dna_rna_tools("ACGT", "transcribe")
print(result)  # Вывод: "UGCA"
```
### Пример использования функции filter_fastq

```python
seqs = {
    "read1": ("ACGTACGT", "IIIIIIII"),
    "read2": ("GGCTAGCT", "IIIIIIII"),
}

filtered = filter_fastq(seqs, gc_bounds=(40, 60), quality_threshold=20)
print(filtered)  # Вывод: {'read1': ('ACGTACGT', 'IIIIIIII')}
```
---

Этот README описывает основные функции и их использование в проекте.
